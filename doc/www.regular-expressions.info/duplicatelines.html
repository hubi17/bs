<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML><HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Regexp Example: Deleting Duplicate Lines or Items with Regular Expressions</TITLE>
<script src="regex.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="Regex Guru" href="http://www.regexguru.com/feed/">
<META NAME="Author" CONTENT="Jan Goyvaerts">
<META NAME="Description" CONTENT="Detailed explanation of a simple regular expression that will delete duplicate lines from a file.  This example illustrates simple yet clever use of capturing parentheses or backreferences.">
<META NAME="Keywords" CONTENT="">
<LINK REL=StyleSheet HREF="regex.css" TYPE="text/css">
</HEAD>
<BODY BGCOLOR=white TEXT=black>
<script type="text/javascript">window.onresize = movecontent;</script>
<DIV id=top><DIV id=logo><IMG SRC="img/logo.gif" WIDTH=530 HEIGHT=100></DIV></DIV>
<div id=btntop><table align=center cellspacing=0 cellpadding=0 border=0><tr><td><a href="tutorial.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Tutorial</div></a></td><td><a href="tools.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Tools&nbsp;&amp;&nbsp;Languages</div></a></td><td><a href="examples.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Examples</div></a></td><td><a href="books.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Books&nbsp;&amp;&nbsp;Reference</div></a></td></tr></table></div>
<DIV id=bodytext>
<script type="text/javascript">movecontent();</script>
<TABLE CLASS=topad> <TR><TD VALIGN=top><A HREF="http://www.regexbuddy.com/library.html" TARGET="_top"><IMG SRC="img/regexbuddyad.png" width=203 height=145 ALT="RegexBuddy" BORDER=0></A></TD> <TD CLASS=topad><B><A HREF="http://www.regexbuddy.com/library.html" TARGET="_top">Collect your own regular expression library</A> with RegexBuddy.</B><BR> RegexBuddy's regular expression library includes all the examples on this website, plus many more. Easily edit any of the regexes or create your own. Build your own personal regular expression library. It'll often come in handy and save you time when searching through files on your computer, writing applications or scripts, or processing text or data. <A HREF="http://www.regexbuddy.com/">Get your own copy of RegexBuddy now</A>.</TD> </TR></TABLE>  <H1>Deleting Duplicate Lines From a File</H1> <P>If you have a file in which all lines are sorted (alphabetically or otherwise), you can easily delete (consecutive) duplicate lines. Simply open the file in <A HREF="editpadpro.html" TARGET="_top">your favorite text editor</A>, and do a search-and-replace searching for <TT CLASS=regex>^(.*)(\r?\n\1)+$</TT> <RXB PAGE=duplicatelines"> and replacing with <TT CLASS=string>\1</TT>. For this to work, the <A HREF="anchors.html" TARGET="_top">anchors</A> need to match before and after line breaks (and not just at the start and the end of the file or string), and the <A HREF="dot.html" TARGET="_top">dot</A> must <EM>not</EM> match newlines.</P> <P>Here is how this works. The <A HREF="anchors.html" TARGET="_top">caret</A> will match only at the start of a line. So the regex engine will only attempt to match the remainder of the regex there. The <A HREF="dot.html" TARGET="_top">dot</A> and <A HREF="repeat.html" TARGET="_top">star</A> combination simply matches an entire line, whatever its contents, if any. The <A HREF="brackets.html" TARGET="_top">round brackets</A> store the matched line into the first backreference.</P> <P>Next we will match the line separator. I put the <A HREF="optional.html" TARGET="_top">question mark</A> into <TT CLASS=regex>\r?\n</TT> to make this regex work with both Windows (\r\n) and UNIX (\n) text files. So up to this point we matched a line and the following line break.</P> <P>Now we need to check if this combination is followed by a duplicate of that same line. We do this simply with <TT CLASS=regex>\1</TT>. This is the first backreference which holds the line we matched. The backreference will match that very same text.</P> <P>If the backreference fails to match, the regex match and the backreference are discarded, and the regex engine tries again at the start of the next line. If the backreference succeeds, the <A HREF="repeat.html" TARGET="_top">plus symbol</A> in the regular expression will try to match additional copies of the line. Finally, the dollar symbol forces the regex engine to check if the text matched by the backreference is a complete line. We already know the text matched by the backreference is preceded by a line break (matched by <TT CLASS=regex>\r?\n</TT>). Therefore, we now check if it is also followed by a line break or if it is at the end of the file using the <A HREF="anchors.html" TARGET="_top">dollar sign</A>.</P> <P>The entire match becomes <TT CLASS=match>line\nline</TT> (or <TT CLASS=match>line\nline\nline</TT> etc.). Because we are doing a search and replace, the line, its duplicates, and the line breaks in between them, are all deleted from the file. Since we want to keep the original line, but not the duplicates, we use <TT CLASS=string>\1</TT> as the replacement text to put the original line back in.</P> <script type="text/javascript"><!--
google_ad_client = "pub-7485249680256358";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "FF6600";
google_color_bg = "FFF4E8";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "803300";
google_ui_features = "rc:0";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script><H2>Removing Duplicate Items From a String</H2> <P>We can generalize the above example to <TT>afterseparator(item)(separator\1)+beforeseparator</TT>, where <TT>afterseparator</TT> and <TT>beforeseparator</TT> are zero-width. So if you want to remove consecutive duplicates from a comma-delimited list, you could use <TT CLASS=regex>(?&lt;=,|^)([^,]*)(,\1)+(?=,|$)</TT> <A HREF="regexbuddy/duplicatecsv.html"><IMG SRC="img/rxb.gif" WIDTH="16" HEIGHT="16" ALIGN=middle ALT="Analyze this regular expression with RegexBuddy" BORDER=0></A>.</P> <P>The <A HREF="lookaround.html" TARGET="_top">positive lookbehind</A> <TT CLASS=regex>(?&lt;=,|^)</TT> forces the regex engine to start matching at the start of the string or after a comma. <TT CLASS=regex>([^,]*)</TT> captures the item. <TT CLASS=regex>(,\1)+</TT> matches consecutive duplicate items. Finally, the <A HREF="lookaround.html" TARGET="_top">positive lookahead</A> <TT CLASS=regex>(?=,|$)</TT> checks if the duplicate items are complete items by checking for a comma or the end of the string.</P><h2>Make a Donation</h2>
<p>Did this website just save you a trip to the bookstore?  Please <a href="donate.html">make a donation</a> to support this site, and you'll get a lifetime of advertisement-free access to this site!</p>
<DIV id=copyright>
<P CLASS=copyright>Page URL: <A HREF="duplicatelines.html" TARGET="_top">http://www.Regular-Expressions.info/duplicatelines.html</A><BR>
Page last updated: 17 August 2012<BR>
Site last updated: 17 June 2013<BR>
Copyright &copy; 2003-2013 Jan Goyvaerts. All rights reserved.</P>
</DIV> 

<script type="text/javascript"><!--
var google_conversion_id = 1072547447; var google_conversion_language = "en"; var google_conversion_format = "3"; var google_conversion_color = "666666"; var google_conversion_label = "sqPQCInO3QEQ94y3_wM"; var google_conversion_value = 0;
//-->
</script>
<script type="text/javascript" src="http://www.googleadservices.com/pagead/conversion.js"></script>
<noscript>
<div style="display:inline;">
<img height="1" width="1" style="border-style:none;" alt="" src="http://www.googleadservices.com/pagead/conversion/1072547447/?label=sqPQCInO3QEQ94y3_wM&amp;guid=ON&amp;script=0"/>
</div>
</noscript>
</DIV> 
<DIV id=side><script type="text/javascript">movecontent();</script><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Examples</TD></TR><TR><TD><A HREF="examples.html" TARGET=_top>Examples</A></TD></TR><TR><TD><A HREF="numericranges.html" TARGET=_top>Numeric&nbsp;Ranges</A></TD></TR><TR><TD><A HREF="floatingpoint.html" TARGET=_top>Floating&nbsp;Point&nbsp;Numbers</A></TD></TR><TR><TD><A HREF="email.html" TARGET=_top>Email&nbsp;Addresses</A></TD></TR><TR><TD><A HREF="dates.html" TARGET=_top>Valid&nbsp;Dates</A></TD></TR><TR><TD><A HREF="creditcard.html" TARGET=_top>Credit&nbsp;Card&nbsp;Numbers</A></TD></TR><TR><TD><A HREF="completelines.html" TARGET=_top>Matching&nbsp;Complete&nbsp;Lines</A></TD></TR><TR><TD><A HREF="duplicatelines.html" TARGET=_top>Deleting&nbsp;Duplicate&nbsp;Lines</A></TD></TR><TR><TD><A HREF="examplesprogrammer.html" TARGET=_top>Programming</A></TD></TR><TR><TD><A HREF="near.html" TARGET=_top>Two&nbsp;Near&nbsp;Words</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Pitfalls</TD></TR><TR><TD><A HREF="catastrophic.html" TARGET=_top>Catastrophic&nbsp;Backtracking</A></TD></TR><TR><TD><A HREF="floatingpoint.html" TARGET=_top>Making&nbsp;Everything&nbsp;Optional</A></TD></TR><TR><TD><A HREF="captureall.html" TARGET=_top>Repeated&nbsp;Capturing&nbsp;Group</A></TD></TR><TR><TD><A HREF="unicode8bit.html" TARGET=_top>Mixing&nbsp;Unicode&nbsp;&amp;&nbsp;8-bit</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>More Information</TD></TR><TR><TD><A HREF="index.html" TARGET=_top>Introduction</A></TD></TR><TR><TD><A HREF="quickstart.html" TARGET=_top>Quick&nbsp;Start</A></TD></TR><TR><TD><A HREF="tutorial.html" TARGET=_top>Tutorial</A></TD></TR><TR><TD><A HREF="tools.html" TARGET=_top>Tools&nbsp;and&nbsp;Languages</A></TD></TR><TR><TD><A HREF="examples.html" TARGET=_top>Examples</A></TD></TR><TR><TD><A HREF="books.html" TARGET=_top>Books</A></TD></TR><TR><TD><A HREF="reference.html" TARGET=_top>Reference</A></TD></TR><TR><TD><A HREF="print.html" TARGET=_top>Print&nbsp;PDF</A></TD></TR><TR><TD><A HREF="about.html" TARGET=_top>About&nbsp;This&nbsp;Site</A></TD></TR><TR><TD><A HREF="updates.html" TARGET=_top>RSS&nbsp;Feed&nbsp;&amp;&nbsp;Blog</A></TD></TR></TABLE><iframe class="amazonsingle" src="http://rcm.amazon.com/e/cm?t=jgsbookselection&o=1&p=8&l=as1&asins=1449319432&md=10FE9736YVPPT7A0FBG2&fc1=000000&IS2=1&lt1=_blank&m=amazon&lc1=0000FF&bc1=000000&bg1=FFFFFF&f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe></DIV><script type="text/javascript">movecontent();</script></BODY></HTML>