<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML><HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Using Regular Expressions with .NET - C# and Visual Basic</TITLE>
<script src="regex.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="Regex Guru" href="http://www.regexguru.com/feed/">
<META NAME="Author" CONTENT="Jan Goyvaerts">
<META NAME="Description" CONTENT="Learn how to use the regular expression classes that are part of the Microsoft .NET (dot net) Framework, and can be readily used in any .NET programming language such as C# (C sharp) or Visual Basic.NET">
<META NAME="Keywords" CONTENT="">
<LINK REL=StyleSheet HREF="regex.css" TYPE="text/css">
</HEAD>
<BODY BGCOLOR=white TEXT=black>
<script type="text/javascript">window.onresize = movecontent;</script>
<DIV id=top><DIV id=logo><IMG SRC="img/logo.gif" WIDTH=530 HEIGHT=100></DIV></DIV>
<div id=btntop><table align=center cellspacing=0 cellpadding=0 border=0><tr><td><a href="tutorial.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Tutorial</div></a></td><td><a href="tools.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Tools&nbsp;&amp;&nbsp;Languages</div></a></td><td><a href="examples.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Examples</div></a></td><td><a href="books.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Books&nbsp;&amp;&nbsp;Reference</div></a></td></tr></table></div>
<DIV id=bodytext>
<script type="text/javascript">movecontent();</script>
<TABLE CLASS=topad> <TR><TD VALIGN=top><A HREF="http://www.regexbuddy.com/csharp.html" TARGET="_top"><IMG SRC="img/regexbuddyad.png" width=203 height=145 ALT="RegexBuddy" BORDER=0></A></TD> <TD CLASS=topad><B><A HREF="http://www.regexbuddy.com/csharp.html" TARGET="_top">Easily use the power of regular expressions in your C# and VB.NET applications</A> with RegexBuddy.</B><BR> Create and analyze regex patterns with RegexBuddy's intuitive regex building blocks. Implement regexes in your applications with instant C# and VB.NET code snippets. Just tell RegexBuddy what you want to achieve, and copy and paste the auto-generated C# or VB.NET code. <A HREF="http://www.regexbuddy.com/">Get your own copy of RegexBuddy now</A>.</TD> </TR></TABLE>  <H1>Using Regular Expressions with The Microsoft .NET Framework</H1> <P>The Microsoft .NET Framework, which you can use with any .NET programming language such as C# (C sharp) or Visual Basic.NET, has solid support for regular expressions. The documentation of the regular expression classes is very poor, however. Read on to learn how to use regular expressions in your .NET applications. In the text below, I will use VB.NET syntax to explain the various classes. After the text, you will find a complete application written in C# to illustrate how to use regular expressions in great detail. I recommend that you download the source code, read the source code and play with the application. That will give you a clear idea how to use regexes in your own applications.</P> <p>As you can see in the <A HREF="refflavors.html" TARGET="_top">regular expression flavor comparison</A>, .NET's regex flavor is very feature-rich. The only noteworthy feature that's lacking are <A HREF="possessive.html" TARGET="_top">possessive quantifiers</A>.</p> <p>There are no differences in the regex flavor supported by .NET versions 1.x, 2.0 and 3.0, except for one feature added in .NET 2.0: <A HREF="xmlcharclass.html" TARGET="_top">character class subtraction</A>. It works exactly the way it does in <A HREF="xml.html" TARGET="_top">XML Schema regular expressions</A>. The XML Schema standard first defined this feature and its syntax.</p> <script type="text/javascript"><!--
google_ad_client = "pub-7485249680256358";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "FF6600";
google_color_bg = "FFF4E8";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "803300";
google_ui_features = "rc:0";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script><H2>System.Text.RegularExpressions Overview (Using VB.NET Syntax)</H2> <P>The regex classes are located in the namespace System.Text.RegularExpressions. To make them available, place <TT CLASS=code>Imports System.Text.RegularExpressions</TT> at the start of your source code.</P> <P>The <TT CLASS=code>Regex</TT> class is the one you use to compile a regular expression. For efficiency, regular expressions are compiled into an internal format. If you plan to use the same regular expression repeatedly, construct a <TT CLASS=code>Regex</TT> object as follows: <TT CLASS=code>Dim RegexObj as Regex = New Regex("regularexpression")</TT>. You can then call <TT CLASS=code>RegexObj.IsMatch("subject")</TT> to check whether the regular expression matches the subject string. The <TT CLASS=code>Regex</TT> allows an optional second parameter of type <TT CLASS=code>RegexOptions</TT>. You could specify <TT CLASS=code>RegexOptions.IgnoreCase</TT> as the final parameter to make the regex case insensitive. Other options are <TT CLASS=code>RegexOptions.Singleline</TT> which causes the <A HREF="dot.html" TARGET="_top">dot to match newlines</A> and <TT CLASS=code>RegexOptions.Multiline</TT> which causes the <A HREF="anchors.html" TARGET="_top">caret and dollar to match at embedded newlines</A> in the subject string.</P> <P>Call <TT CLASS=code>RegexObj.Replace("subject", "replacement")</TT> to perform a search-and-replace using the regex on the subject string, replacing all matches with the replacement string. In the replacement string, you can use <TT CLASS=code>$&</TT> to insert the entire regex match into the replacement text. You can use <TT CLASS=code>$1, $2, $3, etc...</TT> to insert the text matched between <A HREF="brackets.html" TARGET="_top">capturing parentheses</A> into the replacement text. Use <TT CLASS=code>$$</TT> to insert a single dollar sign into the replacement text. To replace with the first backreference immediately followed by the digit 9, use <TT>${1}9</TT>. If you type $19, and there are less than 19 backreferences, the <TT>$19</TT> will be interpreted as literal text, and appear in the result string as such. To insert the text from a <A HREF="named.html" TARGET="_top">named capturing group</A>, use <TT>${name}</TT>. Improper use of the $ sign may produce an undesirable result string, but will never cause an exception to be raised.</P> <P><TT CLASS=code>RegexObj.Split("Subject")</TT> splits the subject string along regex matches, returning an array of strings. The array contains the text between the regex matches. If the regex contains <A HREF="brackets.html" TARGET="_top">capturing parentheses</A>, the text matched by them is also included in the array. If you want the entire regex matches to be included in the array, simply place round brackets around the entire regular expression when instantiating <TT CLASS=code>RegexObj</TT>.</P> <P>The <TT CLASS=code>Regex</TT> class also contains several static methods that allow you to use regular expressions without instantiating a <TT CLASS=code>Regex</TT> object. This reduces the amount of code you have to write, and is appropriate if the same regular expression is used only once or reused seldomly. Note that member overloading is used a lot in the <TT CLASS=code>Regex</TT> class. All the static methods have the same names (but different parameter lists) as other non-static methods.</P> <P><TT CLASS=code>Regex.IsMatch("subject", "regex")</TT> checks if the regular expression matches the subject string. <TT CLASS=code>Regex.Replace("subject", "regex", "replacement")</TT> performs a search-and-replace. <TT CLASS=code>Regex.Split("subject", "regex")</TT> splits the subject string into an array of strings as described above. All these methods accept an optional additional parameter of type <TT CLASS=code>RegexOptions</TT>, like the constructor.</P> <H2>The System.Text.RegularExpressions.Match Class</H2> <P>If you want more information about the regex match, call <TT CLASS=code>Regex.Match()</TT> to construct a <TT CLASS=code>Match</TT> object. If you instantiated a <TT CLASS=code>Regex</TT> object, use <TT CLASS=code>Dim MatchObj as Match = RegexObj.Match("subject")</TT>. If not, use the static version: <TT CLASS=code>Dim MatchObj as Match = Regex.Match("subject", "regex")</TT>.</P> <P>Either way, you will get an object of class <TT CLASS=code>Match</TT> that holds the details about the first regex match in the subject string. <TT CLASS=code>MatchObj.Success</TT> indicates if there actually was a match. If so, use <TT CLASS=code>MatchObj.Value</TT> to get the contents of the match, <TT CLASS=code>MatchObj.Length</TT> for the length of the match, and <TT CLASS=code>MatchObj.Index</TT> for the start of the match in the subject string. The start of the match is zero-based, so it effectively counts the number of characters in the subject string to the left of the match.</P> <P>If the regular expression contains <A HREF="brackets.html" TARGET="_top">capturing parentheses</A>, use the <TT CLASS=code>MatchObj.Groups</TT> collection. <TT CLASS=code>MatchObj.Groups.Count</TT> indicates the number of capturing parentheses. The count includes the zeroth group, which is the entire regex match. <TT CLASS=code>MatchObj.Groups(3).Value</TT> gets the text matched by the third pair of round brackets. <TT CLASS=code>MatchObj.Groups(3).Length</TT> and <TT CLASS=code>MatchObj.Groups(3).Index</TT> get the length of the text matched by the group and its index in the subject string, relative to the start of the subject string. <TT CLASS=code>MatchObj.Groups("name")</TT> gets the details of the <A HREF="named.html" TARGET="_top">named group</A> "name". </P> <P>To find the next match of the regular expression in the same subject string, call <TT CLASS=code>MatchObj.NextMatch()</TT> which returns a new <TT CLASS=code>Match</TT> object containing the results for the second match attempt. You can continue calling <TT CLASS=code>MatchObj.NextMatch()</TT> until <TT CLASS=code>MatchObj.Success</TT> is False.</P> <P>Note that after calling <TT CLASS=code>RegexObj.Match()</TT>, the resulting <TT CLASS=code>Match</TT> object is independent from <TT CLASS=code>RegexObj</TT>. This means you can work with several <TT CLASS=code>Match</TT> objects created by the same <TT CLASS=code>Regex</TT> object simultaneously.</P> <H2>Regular Expressions, Literal Strings and Backslashes</H2> <P>In literal C# strings, as well as in C++ and many other .NET languages, the backslash is an escape character. The literal string <TT CLASS=code>"\\"</TT> is a single backslash. In regular expressions, the backslash is also an escape character. The regular expression <TT CLASS=regex>\\</TT> matches a single backslash. This regular expression as a C# string, becomes <TT CLASS=code>"\\\\"</TT>. That's right: 4 backslashes to match a single one.</P> <P>The regex <TT CLASS=regex>\w</TT> matches a word character. As a C# string, this is written as <TT CLASS=code>"\\w"</TT>.</P> <P>To make your code more readable, you should use C# verbatim strings. In a verbatim string, a backslash is an ordinary character. This allows you to write the regular expression in your C# code as you would write it a tool like <A HREF="regexbuddy.html" TARGET="_top">RegexBuddy</A> or <A HREF="powergrep.html" TARGET="_top">PowerGREP</A>, or as the user would type it into your application. The regex to match a backlash is written as <TT CLASS=code>@"\\"</TT> when using C# verbatim strings. The backslash is still an escape character in the regular expression, so you still need to double it. But doubling is better than quadrupling. To match a word character, use the verbatim string <TT CLASS=code>@"\w"</TT>.</P> <H2>.NET Framework Demo Application using Regular Expressions (C# Syntax)</H2> <P>To really get to grips with the regex support of the Microsoft .NET Framework, I recommend that you study the demo application I created. It is written in C#. The demo is fairly simple, so you should understand the source code even if you do not use C# yourself. The demo code has lots of comments that clearly indicate what my code does, why I coded it that way, and which other options you have. The demo code also catches all exceptions that may be thrown by the various methods, something I did not explain above.</P> <P>The demo application covers every aspect of the System.Text.RegularExpressions package. You can use it to learn how to use the package, and to quickly test regular expressions while coding.</P> <P><A HREF="dotnetexample.html" TARGET="_top">Read the source code in your web browser</A></P> <P><A HREF="http://www.regular-expressions.info/download/csharpregexdemo.zip">Download the demo application and source code</A></P> <H2>Further Reading</H2> <P><A HREF="hipowls.html" TARGET="_top"><IMG SRC="books/hipowlssmall.jpg" WIDTH=122 HEIGHT=160 ALT="Mastering Regular Expressions" BORDER=0 ALIGN=right CLASS=right></A>The book <A HREF="hipowls.html" TARGET="_top">Mastering Regular Expressions</A> not only explains everything you want to know and don't want to know about regular expressions, including the regex features that are unique to .NET. It has an excellent chapter on .NET's System.Text.RegularExpressions namespace, explaining the various Regex classes far better than Microsoft's documentatio, with plenty of example VB.NET example code and some C# code showing more advanced techniques.</P> <p><A HREF="hipowls.html" TARGET="_top">My review of the book Mastering Regular Expressions</A></p> <ul> <li><A HREF="http://www.amazon.com/exec/obidos/ASIN/0596528124/jgsbookselection">Buy Mastering Regular Expressions from Amazon.com</A> <li><A HREF="http://www.amazon.co.uk/exec/obidos/ASIN/0596528124/jgsbookselect">Buy Mastering Regular Expressions from Amazon.co.uk</A> <li><A HREF="http://www.amazon.fr/exec/obidos/ASIN/0596528124/regularexpres-21">Buy Mastering Regular Expressions from Amazon.fr</A> <li><A HREF="http://www.amazon.de/exec/obidos/ASIN/0596528124/regularexpr0a-21">Buy Mastering Regular Expressions from Amazon.de</A> <li><a href="http://www.amazon.de/exec/obidos/ASIN/3897217201/regularexpr0a-21">Buy Reguläre Ausdrücke from Amazon.de</a> </ul> <h2>Make a Donation</h2>
<p>Did this website just save you a trip to the bookstore?  Please <a href="donate.html">make a donation</a> to support this site, and you'll get a lifetime of advertisement-free access to this site!</p>
<DIV id=copyright>
<P CLASS=copyright>Page URL: <A HREF="dotnet.html" TARGET="_top">http://www.Regular-Expressions.info/dotnet.html</A><BR>
Page last updated: 02 December 2010<BR>
Site last updated: 17 June 2013<BR>
Copyright &copy; 2003-2013 Jan Goyvaerts. All rights reserved.</P>
</DIV> 

<script type="text/javascript"><!--
var google_conversion_id = 1072547447; var google_conversion_language = "en"; var google_conversion_format = "3"; var google_conversion_color = "666666"; var google_conversion_label = "sqPQCInO3QEQ94y3_wM"; var google_conversion_value = 0;
//-->
</script>
<script type="text/javascript" src="http://www.googleadservices.com/pagead/conversion.js"></script>
<noscript>
<div style="display:inline;">
<img height="1" width="1" style="border-style:none;" alt="" src="http://www.googleadservices.com/pagead/conversion/1072547447/?label=sqPQCInO3QEQ94y3_wM&amp;guid=ON&amp;script=0"/>
</div>
</noscript>
</DIV> 
<DIV id=side><script type="text/javascript">movecontent();</script><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Regex Tools</TD></TR><TR><TD><A HREF="grep.html" TARGET=_top>grep</A></TD></TR><TR><TD><A HREF="powergrep.html" TARGET=_top>PowerGREP</A></TD></TR><TR><TD><A HREF="regexbuddy.html" TARGET=_top>RegexBuddy</A></TD></TR><TR><TD><A HREF="regexmagic.html" TARGET=_top>RegexMagic</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>General Applications</TD></TR><TR><TD><A HREF="editpadpro.html" TARGET=_top>EditPad&nbsp;Pro</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Languages &amp; Libraries</TD></TR><TR><TD><A HREF="delphi.html" TARGET=_top>Delphi</A></TD></TR><TR><TD><A HREF="gnu.html" TARGET=_top>GNU&nbsp;(Linux)</A></TD></TR><TR><TD><A HREF="groovy.html" TARGET=_top>Groovy</A></TD></TR><TR><TD><A HREF="java.html" TARGET=_top>Java</A></TD></TR><TR><TD><A HREF="javascript.html" TARGET=_top>JavaScript</A></TD></TR><TR><TD><A HREF="dotnet.html" TARGET=_top>.NET</A></TD></TR><TR><TD><A HREF="pcre.html" TARGET=_top>PCRE&nbsp;(C/C++)</A></TD></TR><TR><TD><A HREF="perl.html" TARGET=_top>Perl</A></TD></TR><TR><TD><A HREF="php.html" TARGET=_top>PHP</A></TD></TR><TR><TD><A HREF="posix.html" TARGET=_top>POSIX</A></TD></TR><TR><TD><A HREF="powershell.html" TARGET=_top>PowerShell</A></TD></TR><TR><TD><A HREF="python.html" TARGET=_top>Python</A></TD></TR><TR><TD><A HREF="rlanguage.html" TARGET=_top>R</A></TD></TR><TR><TD><A HREF="realbasic.html" TARGET=_top>REALbasic</A></TD></TR><TR><TD><A HREF="ruby.html" TARGET=_top>Ruby</A></TD></TR><TR><TD><A HREF="tcl.html" TARGET=_top>Tcl</A></TD></TR><TR><TD><A HREF="vbscript.html" TARGET=_top>VBScript</A></TD></TR><TR><TD><A HREF="vb.html" TARGET=_top>Visual&nbsp;Basic&nbsp;6</A></TD></TR><TR><TD><A HREF="wxwidgets.html" TARGET=_top>wxWidgets</A></TD></TR><TR><TD><A HREF="xml.html" TARGET=_top>XML&nbsp;Schema</A></TD></TR><TR><TD><A HREF="xpath.html" TARGET=_top>XQuery&nbsp;&amp;&nbsp;XPath</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Databases</TD></TR><TR><TD><A HREF="mysql.html" TARGET=_top>MySQL</A></TD></TR><TR><TD><A HREF="oracle.html" TARGET=_top>Oracle</A></TD></TR><TR><TD><A HREF="postgresql.html" TARGET=_top>PostgreSQL</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>More Information</TD></TR><TR><TD><A HREF="index.html" TARGET=_top>Introduction</A></TD></TR><TR><TD><A HREF="quickstart.html" TARGET=_top>Quick&nbsp;Start</A></TD></TR><TR><TD><A HREF="tutorial.html" TARGET=_top>Tutorial</A></TD></TR><TR><TD><A HREF="tools.html" TARGET=_top>Tools&nbsp;and&nbsp;Languages</A></TD></TR><TR><TD><A HREF="examples.html" TARGET=_top>Examples</A></TD></TR><TR><TD><A HREF="books.html" TARGET=_top>Books</A></TD></TR><TR><TD><A HREF="reference.html" TARGET=_top>Reference</A></TD></TR><TR><TD><A HREF="print.html" TARGET=_top>Print&nbsp;PDF</A></TD></TR><TR><TD><A HREF="about.html" TARGET=_top>About&nbsp;This&nbsp;Site</A></TD></TR><TR><TD><A HREF="updates.html" TARGET=_top>RSS&nbsp;Feed&nbsp;&amp;&nbsp;Blog</A></TD></TR></TABLE><iframe class="amazonsingle" src="http://rcm.amazon.com/e/cm?t=jgsbookselection&o=1&p=8&l=as1&asins=1449319432&md=10FE9736YVPPT7A0FBG2&fc1=000000&IS2=1&lt1=_blank&m=amazon&lc1=0000FF&bc1=000000&bg1=FFFFFF&f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe><div>
<script type="text/javascript"><!--
google_ad_client = "pub-7485249680256358";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "FF6600";
google_color_bg = "FFF4E8";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "803300";
google_ui_features = "rc:0";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div><P>&nbsp;</P> <TABLE CLASS=sidead CELLSPACING=0 CELLPADDING=4> <TR><TD CLASS=sideheader>PowerGREP 4</TD></TR> <TR><TD CLASS=ad><A HREF="http://www.powergrep.com/" TARGET=_top><IMG SRC="img/pgr.gif" WIDTH=32 HEIGHT=32 ALT="PowerGREP" ALIGN=LEFT CLASS=iconleft BORDER=0></A> <A HREF="http://www.powergrep.com/" TARGET=_top>PowerGREP</A> is probably the most powerful regex-based text processing tool available today. A knowledge worker's Swiss army knife for searching through, extracting information from, and updating piles of files.</TD></TR> <TR><TD CLASS=ad>Use regular expressions to search through large numbers of text and binary files. Quickly find the files you are looking for, or extract the information you need. Look through just a handful of files or folders, or scan entire drives and network shares.</TD></TR> <TR><TD CLASS=ad>Search and replace using text, binary data or one or more regular expressions to automate repetitive editing tasks. Preview replacements before modifying files, and stay safe with flexible backup and undo options.</TD></TR> <TR><TD CLASS=ad>Use regular expressions to rename files, copy files, or merge and split the contents of files. Work with plain text files, Unicode files, binary files, compressed files, and files in proprietary formats such as MS Office, OpenOffice, and PDF. Runs on Windows 2000, XP, Vista, 7, and 8.</TD></TR> <TR><TD><A HREF="http://www.powergrep.com/" TARGET=_top>More information</A></TD></TR> <TR><TD><A HREF="http://www.powergrep.com/download.html" TARGET=_top>Download PowerGREP now</A></TD></TR> </TABLE></DIV><script type="text/javascript">movecontent();</script></BODY></HTML>