<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML><HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Delphi Regular Expressions Classes</TITLE>
<script src="regex.js" type="text/javascript"></script>
<link rel="alternate" type="application/rss+xml" title="Regex Guru" href="http://www.regexguru.com/feed/">
<META NAME="Author" CONTENT="Jan Goyvaerts">
<META NAME="Description" CONTENT="">
<META NAME="Keywords" CONTENT="">
<LINK REL=StyleSheet HREF="regex.css" TYPE="text/css">
</HEAD>
<BODY BGCOLOR=white TEXT=black>
<script type="text/javascript">window.onresize = movecontent;</script>
<DIV id=top><DIV id=logo><IMG SRC="img/logo.gif" WIDTH=530 HEIGHT=100></DIV></DIV>
<div id=btntop><table align=center cellspacing=0 cellpadding=0 border=0><tr><td><a href="tutorial.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Tutorial</div></a></td><td><a href="tools.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Tools&nbsp;&amp;&nbsp;Languages</div></a></td><td><a href="examples.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Examples</div></a></td><td><a href="books.html" target="_top"><div onmouseover="this.style.backgroundColor='#33A000';this.style.backgroundImage='url(img/btnhot.gif)';" onmouseout="this.style.backgroundColor='#A03300';this.style.backgroundImage='url(img/btn.gif)';return false;">Books&nbsp;&amp;&nbsp;Reference</div></a></td></tr></table></div>
<DIV id=bodytext>
<script type="text/javascript">movecontent();</script>
<TABLE CLASS=topad> <TR><TD VALIGN=top><A HREF="http://www.regexbuddy.com/delphi.html" TARGET="_top"><IMG SRC="img/regexbuddyad.png" width=203 height=145 ALT="RegexBuddy" BORDER=0></A></TD> <TD CLASS=topad><B><A HREF="http://www.regexbuddy.com/delphi.html" TARGET="_top">Easily use the power of regular expressions in your Delphi applications</A> with RegexBuddy.</B><BR> Create and analyze regex patterns with RegexBuddy's intuitive regex building blocks. Implement regexes in your applications with instant Delphi for .NET and Win32 code snippets. Just tell RegexBuddy what you want to achieve, and copy and paste the auto-generated Delphi code. <A HREF="http://www.regexbuddy.com/">Get your own copy of RegexBuddy now</A>.</TD> </TR></TABLE>  <H1>Delphi Regular Expressions Classes</H1> <p>Delphi XE is the first release of Delphi that has built-in support for regular expressions. In most cases you'll use the RegularExpressions unit. This unit defines a set of records that mimic the regular expression classes in the .NET framework. Just like in .NET, they allow you to use a regular expression in just one line of code without explicit memory management.</p> <p>Internally the RegularExpressions unit uses the RegularExpressionsCore unit which defines the TPerlRegEx class. TPerlRegEx is a wrapper around the open source <A HREF="pcre.html" TARGET="_top">PCRE library</A> developed by the author of this website. Thus both the RegularExpressions and RegularExprssionsCore units use the PCRE <A HREF="refflavors.html" TARGET="_top">regex flavor</A>.</p> <p>In situations where performance is critical, you may want to use TPerlRegEx directly. The PCRE library is based on UTF-8 while the Delphi VCL uses UTF-16 (UnicodeString). TPerlRegEx is also based on UTF-8, giving you full control over the conversion between UTF-16 and UTF-8. You can avoid the conversions if your own code also uses UTF8String. The RegularExpressions unit uses UnicodeString just like the rest of the VCL, and handles the UTF-16 to UTF-8 conversion automatically.</p> <p>For new code written in Delphi XE, you should definitely use the RegularExpressions unit that is part of Delphi rather than one of the many 3rd party units that may be available. If you're dealing with UTF-8 data, use the RegularExpressionsCore unit to avoid needless UTF-8 to UTF-16 to UTF-8 conversions.</p> <p>If you have old code written using TPerlRegEx that you're migrating to Delphi XE, replace the PerlRegEx unit with RegularExpressionsCore, and update the changed property and method names as described in the section about older versions of Delphi.</p> <script type="text/javascript"><!--
google_ad_client = "pub-7485249680256358";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "FF6600";
google_color_bg = "FFF4E8";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "803300";
google_ui_features = "rc:0";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script><h2>Delphi XE RegularExpressions unit</h2> <p>The RegularExpressions unit defines <tt class=code>TRegEx</tt>, <tt class=code>TMatch</tt>, <tt class=code>TMatchCollection</tt>, <tt class=code>TGroup</tt>, and <tt class=code>TGroupCollection</tt> as records rather than as classes. That means you don't need to call <tt class=code>Create</tt> and <tt class=code>Free</tt> to allocate and deallocate memory.</p> <p><tt class=code>TRegEx</tt> does have a <b><tt class=code>Create</tt></b> constructor that you can call if you want to use the same regular expression more than once. That way <tt class=code>TRegEx</tt> doesn't compile the same regex twice. If you call the constructor, you can then call any of the non-static methods that do not take the regular expression as a parameter. If you don't call the constructor, you can only call the static (class) methods that take the regular expression as a parameter. All <tt class=code>TRegEx</tt> methods have static and non-static overloads. Which ones you use solely depends on whether you want to make more than one call to <tt class=code>TRegEx</tt> using the same regular expression.</p> <p>The <b><tt class=code>IsMatch</tt></b> method takes a string and returns True or False indicating whether the regular expression matches (part of) the string.</p> <p>The <b><tt class=code>Match</tt></b> method takes a string and returns a <tt class=code>TMatch</tt> record with the details of the first match. If the match fails, it returns a <tt class=code>TMatch</tt> record with the <tt class=code>Success</tt> property set to <tt class=code>nil</tt>. The non-static overload of <tt class=code>Match()</tt> takes an optional starting position and an optional length parameter that you can use to search through only part of the input string.</p> <p>The <b><tt class=code>Matches</tt></b> method takes a string and returns a <tt class=code>TMatchCollection</tt> record. The default <tt class=code>Item[]</tt> property of this record holds a <tt class=code>TMatch</tt> for each match the regular expression found in the string. If there are no matches, the <tt class=code>Count</tt> property of the returned <tt class=code>TMatchCollection</tt> record is zero.</p> <p>Use the <b><tt class=code>Replace</tt></b> method to search-and-replace all matches in a string. You can pass the replacement text as a string using the <A HREF="refreplace.html" TARGET="_top">JGsoft replacement text flavor</A>. Or, you can pass a <tt class=code>TMatchEvaluator</tt> which is nothing more than a method that takes one parameter called <tt class=code>Match</tt> of type <tt class=code>TMatch</tt> and returns a string. The string returned by your method is used as a literal replacement string. If you want backreferences in your string to be replaced when using the <tt class=code>TMatchEvaluator</tt> overload, call the <tt class=code>Result</tt> method on the provided <tt class=code>Match</tt> parameter before returning the string.</p> <p>Use the <b><tt class=code>Split</tt></b> method to split a string along its regex matches. The result is returned as a dynamic array of strings. As in .NET, text matched by <A HREF="brackets.html" TARGET="_top">capturing groups</A> in the regular expression are also included in the returned array. If you don't like this, remove all <A HREF="named.html" TARGET="_top">named capturing groups</A> from your regex and pass the <tt class=code>roExplicitCapture</tt> option to disable numbered capturing groups. The non-static overload of <tt class=code>Split()</tt> takes an optional <tt class=code>Count</tt> parameter to indicate the maximum number of elements that the returned array may have. In other words, the string is split at most <tt class=code>Count-1</tt> times. Capturing group matches are not included in the count. So if your regex has capturing groups, the returned array may have more than <tt class=code>Count</tt> elements. If you pass <tt class=code>Count</tt>, you can pass a second optional parameter to indicate the position in the string at which to start splitting. The part of the string before the starting position is returned unsplit in the first element of the returned array.</p> <p>The <b><tt class=code>TMatch</tt></b> record provides several properties with details about the match. <tt class=code>Success</tt> indicates if a match was found. If this is False, all other properties and methods are invalid. <tt class=code>Value</tt> returns the matched string. <tt class=code>Index</tt> and <tt class=code>Length</tt> indicate the position in the input string and the length of the match. <tt class=code>Groups</tt> returns a TGroupCollection record that stores a <tt class=code>TGroup</tt> record in its default <tt class=code>Item[]</tt> property for each capturing group. You can use a numeric index to <tt class=code>Item[]</tt> for numbered capturing groups, and a string index for <A HREF="named.html" TARGET="_top">named capturing groups</A>.</p> <p><b><tt class=code>TMatch</tt></b> also provides two methods. <tt class=code>NextMatch</tt> returns the next match of the regular expression after this one. If your <tt class=code>TMatch</tt> is part of a <tt class=code>TMatchCollection</tt> you should not use <tt class=code>NextMatch</tt> to get the next match but use <tt class=code>TMatchCollection.Item[]</tt> instead, in order to avoid repeating the search. <tt class=code>TMatch.Result</tt> takes one parameter with the replacement text as a string using the <A HREF="refreplace.html" TARGET="_top">JGsoft replacement text flavor</A>. It returns the string that this match would have been replaced with if you had used this replacement text with <tt class=code>TRegEx.Replace</tt>.</p> <p>The <b><tt class=code>TGroup</tt></b> record has <tt class=code>Success</tt>, <tt class=code>Value</tt>, <tt class=code>Index</tt> and <tt class=code>Length</tt> properties that work just like those of the <tt class=code>TMatch</tt>.</p> <h2>Regular Expressions Classes for Older Versions of Delphi</h2> <P>TPerlRegEx has been available long before Embarcadero licensed a copy for inclusion with Delphi XE. Depending on your needs, you can download one of two versions for use with Delphi 2010 and earlier.</P> <ul> <li><A HREF="http://www.regular-expressions.info/download/TPerlRegEx.zip">Download the latest class-based TPerlRegEx</a></li> <li><A HREF="http://www.regular-expressions.info/download/TPerlRegEx2009.zip">Download the older component-based TPerlRegEx</a></li> </ul> <P>The latest release of TPerlRegEx is fully compatible with the RegularExpressionsCore unit in Delphi XE. For new code written in Delphi 2010 or earlier, using the latest release of TPerlRegEx is strongly recommended. If you later migrate your code to Delphi XE, all you have to do is replace PerlRegEx with RegularExrpessionsCore in the uses clause of your units.</P> <p>The older versions of TPerlRegEx are non-visual components. This means you can put TPerlRegEx on the component palette and drop it on a form. The original TPerlRegEx was developed when Borland's goal was to have a component for everything on the component palette.</p> <p>If you want to migrate from an older version of TPerlRegEx to the latest TPerlRegEx, start with removing any TPerlRegEx components you may have placed on forms or data modules and instantiate the objects at runtime instead. When instantiating at runtime, you no longer need to pass an owner component to the <tt class=code>Create()</tt> constructor. Simply remove the parameter.</p> <p>Some of the property and method names in the original TPerlRegEx were a bit unwieldy. These have been renamed in the latest TPerlRegEx. Essentially, in all identifiers <tt>SubExpression</tt> was replaced with <tt>Group</tt> and <tt>MatchedExpression</tt> was replaced with <tt>Matched</tt>. Here is a complete list of the changed identifiers:</p> <table border=1 cellspacing=0 cellpadding=4 class=body><tr><th>Old Identifier</th><th>New Identifier</th></tr> <tr><td><tt>StoreSubExpression</tt></td><td><tt>StoreGroups</tt></td></tr> <tr><td><tt>NamedSubExpression</tt></td><td><tt>NamedGroup</tt></td></tr> <tr><td><tt>MatchedExpression</tt></td><td><tt>MatchedText</tt></td></tr> <tr><td><tt>MatchedExpressionLength</tt></td><td><tt>MatchedLength</tt></td></tr> <tr><td><tt>MatchedExpressionOffset</tt></td><td><tt>MatchedOffset</tt></td></tr> <tr><td><tt>SubExpressionCount</tt></td><td><tt>GroupCount</tt></td></tr> <tr><td><tt>SubExpressions</tt></td><td><tt>Groups</tt></td></tr> <tr><td><tt>SubExpressionLengths</tt></td><td><tt>GroupLengths</tt></td></tr> <tr><td><tt>SubExpressionOffsets</tt></td><td><tt>GroupOffsets</tt></td></tr> </table> <p>If you're using RegexBuddy or RegexMagic to <A HREF="http://www.regexbuddy.com/delphi.html" TARGET="_top">generate Delphi code snippets</A>, set the language to "Delphi (TPerlRegEx)" to use the old identifiers, or to "Delphi XE (Core)" to use the new identifiers, regardless of which version of Delphi you're actually using.</p> <H2>Use System.Text.RegularExpressions with Delphi Prism</H2> <P>Delphi Prism is Embarcadero's new variant on the Delphi language, formerly known as RemObjects Oxygene, formerly known as RemObjects Chrome. Delphi Prism lives inside the Visual Studio IDE, and is based entirely on the .NET framework. Simply add the <A HREF="dotnet.html" TARGET="_top">System.Text.RegularExpressions</A> namespace to the uses clause of your Delphi Prism units, and you can access the .NET regex classes such as Regex, Match, and Group. You can use them with Delphi Prism just as they can be used by <A HREF="dotnet.html" TARGET="_top">C# and VB</A> developers.</P> <H2>Use System.Text.RegularExpressions with Delphi for .NET</H2> <P>Delphi 8, 2005, 2006, and 2007 included a Delphi for .NET compiler for developing WinForms and VCL.NET applications. Though Delphi for .NET only supports .NET 1.1 or 2.0, depending on your Delphi version, you can still use .NET's full regular expression support. Simply add the <A HREF="dotnet.html" TARGET="_top">System.Text.RegularExpressions</A> namespace to the uses clause, and you can access all the .NET regex classes.</P> <h2>Make a Donation</h2>
<p>Did this website just save you a trip to the bookstore?  Please <a href="donate.html">make a donation</a> to support this site, and you'll get a lifetime of advertisement-free access to this site!</p>
<DIV id=copyright>
<P CLASS=copyright>Page URL: <A HREF="delphi.html" TARGET="_top">http://www.Regular-Expressions.info/delphi.html</A><BR>
Page last updated: 19 July 2011<BR>
Site last updated: 17 June 2013<BR>
Copyright &copy; 2003-2013 Jan Goyvaerts. All rights reserved.</P>
</DIV> 

<script type="text/javascript"><!--
var google_conversion_id = 1072547447; var google_conversion_language = "en"; var google_conversion_format = "3"; var google_conversion_color = "666666"; var google_conversion_label = "sqPQCInO3QEQ94y3_wM"; var google_conversion_value = 0;
//-->
</script>
<script type="text/javascript" src="http://www.googleadservices.com/pagead/conversion.js"></script>
<noscript>
<div style="display:inline;">
<img height="1" width="1" style="border-style:none;" alt="" src="http://www.googleadservices.com/pagead/conversion/1072547447/?label=sqPQCInO3QEQ94y3_wM&amp;guid=ON&amp;script=0"/>
</div>
</noscript>
</DIV> 
<DIV id=side><script type="text/javascript">movecontent();</script><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Regex Tools</TD></TR><TR><TD><A HREF="grep.html" TARGET=_top>grep</A></TD></TR><TR><TD><A HREF="powergrep.html" TARGET=_top>PowerGREP</A></TD></TR><TR><TD><A HREF="regexbuddy.html" TARGET=_top>RegexBuddy</A></TD></TR><TR><TD><A HREF="regexmagic.html" TARGET=_top>RegexMagic</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>General Applications</TD></TR><TR><TD><A HREF="editpadpro.html" TARGET=_top>EditPad&nbsp;Pro</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Languages &amp; Libraries</TD></TR><TR><TD><A HREF="delphi.html" TARGET=_top>Delphi</A></TD></TR><TR><TD><A HREF="gnu.html" TARGET=_top>GNU&nbsp;(Linux)</A></TD></TR><TR><TD><A HREF="groovy.html" TARGET=_top>Groovy</A></TD></TR><TR><TD><A HREF="java.html" TARGET=_top>Java</A></TD></TR><TR><TD><A HREF="javascript.html" TARGET=_top>JavaScript</A></TD></TR><TR><TD><A HREF="dotnet.html" TARGET=_top>.NET</A></TD></TR><TR><TD><A HREF="pcre.html" TARGET=_top>PCRE&nbsp;(C/C++)</A></TD></TR><TR><TD><A HREF="perl.html" TARGET=_top>Perl</A></TD></TR><TR><TD><A HREF="php.html" TARGET=_top>PHP</A></TD></TR><TR><TD><A HREF="posix.html" TARGET=_top>POSIX</A></TD></TR><TR><TD><A HREF="powershell.html" TARGET=_top>PowerShell</A></TD></TR><TR><TD><A HREF="python.html" TARGET=_top>Python</A></TD></TR><TR><TD><A HREF="rlanguage.html" TARGET=_top>R</A></TD></TR><TR><TD><A HREF="realbasic.html" TARGET=_top>REALbasic</A></TD></TR><TR><TD><A HREF="ruby.html" TARGET=_top>Ruby</A></TD></TR><TR><TD><A HREF="tcl.html" TARGET=_top>Tcl</A></TD></TR><TR><TD><A HREF="vbscript.html" TARGET=_top>VBScript</A></TD></TR><TR><TD><A HREF="vb.html" TARGET=_top>Visual&nbsp;Basic&nbsp;6</A></TD></TR><TR><TD><A HREF="wxwidgets.html" TARGET=_top>wxWidgets</A></TD></TR><TR><TD><A HREF="xml.html" TARGET=_top>XML&nbsp;Schema</A></TD></TR><TR><TD><A HREF="xpath.html" TARGET=_top>XQuery&nbsp;&amp;&nbsp;XPath</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Databases</TD></TR><TR><TD><A HREF="mysql.html" TARGET=_top>MySQL</A></TD></TR><TR><TD><A HREF="oracle.html" TARGET=_top>Oracle</A></TD></TR><TR><TD><A HREF="postgresql.html" TARGET=_top>PostgreSQL</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>More Information</TD></TR><TR><TD><A HREF="index.html" TARGET=_top>Introduction</A></TD></TR><TR><TD><A HREF="quickstart.html" TARGET=_top>Quick&nbsp;Start</A></TD></TR><TR><TD><A HREF="tutorial.html" TARGET=_top>Tutorial</A></TD></TR><TR><TD><A HREF="tools.html" TARGET=_top>Tools&nbsp;and&nbsp;Languages</A></TD></TR><TR><TD><A HREF="examples.html" TARGET=_top>Examples</A></TD></TR><TR><TD><A HREF="books.html" TARGET=_top>Books</A></TD></TR><TR><TD><A HREF="reference.html" TARGET=_top>Reference</A></TD></TR><TR><TD><A HREF="print.html" TARGET=_top>Print&nbsp;PDF</A></TD></TR><TR><TD><A HREF="about.html" TARGET=_top>About&nbsp;This&nbsp;Site</A></TD></TR><TR><TD><A HREF="updates.html" TARGET=_top>RSS&nbsp;Feed&nbsp;&amp;&nbsp;Blog</A></TD></TR></TABLE><div>
<script type="text/javascript"><!--
google_ad_client = "pub-7485249680256358";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "FF6600";
google_color_bg = "FFF4E8";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "803300";
google_ui_features = "rc:0";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div><P>&nbsp;</P> <TABLE CLASS=sidead CELLSPACING=0 CELLPADDING=4> <TR><TD CLASS=sideheader>PowerGREP 4</TD></TR> <TR><TD CLASS=ad><A HREF="http://www.powergrep.com/" TARGET=_top><IMG SRC="img/pgr.gif" WIDTH=32 HEIGHT=32 ALT="PowerGREP" ALIGN=LEFT CLASS=iconleft BORDER=0></A> <A HREF="http://www.powergrep.com/" TARGET=_top>PowerGREP</A> is probably the most powerful regex-based text processing tool available today. A knowledge worker's Swiss army knife for searching through, extracting information from, and updating piles of files.</TD></TR> <TR><TD CLASS=ad>Use regular expressions to search through large numbers of text and binary files. Quickly find the files you are looking for, or extract the information you need. Look through just a handful of files or folders, or scan entire drives and network shares.</TD></TR> <TR><TD CLASS=ad>Search and replace using text, binary data or one or more regular expressions to automate repetitive editing tasks. Preview replacements before modifying files, and stay safe with flexible backup and undo options.</TD></TR> <TR><TD CLASS=ad>Use regular expressions to rename files, copy files, or merge and split the contents of files. Work with plain text files, Unicode files, binary files, compressed files, and files in proprietary formats such as MS Office, OpenOffice, and PDF. Runs on Windows 2000, XP, Vista, 7, and 8.</TD></TR> <TR><TD><A HREF="http://www.powergrep.com/" TARGET=_top>More information</A></TD></TR> <TR><TD><A HREF="http://www.powergrep.com/download.html" TARGET=_top>Download PowerGREP now</A></TD></TR> </TABLE></DIV><script type="text/javascript">movecontent();</script></BODY></HTML>